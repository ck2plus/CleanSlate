# These are here because they malfunction when cross-referencing within the actual government potentials and allows
# NOTE: Holdings and Laws are not loaded until after the game starts. EXTREMELY DELICATE, modify at your own risk

# Feudal Group
feudal_group_potential_trigger = { # For values shared by multiple government types
	# Universal Rules
	trigger_if = {
		limit = { controls_religion = yes }

		temporal_religious_head_trigger = yes
	}

	# These governments don't play by the non-universal rules
	trigger_if = {
		limit = {
			chinese_imperial_government_potential_trigger = no
			order_government_potential_trigger = no
			roman_imperial_government_potential_trigger = no
		}
		is_patrician = no

		trigger_if = {
			limit = { has_game_started = yes }

			# Keep Tribes and Nomads from instant-switching to Feudal/Republican
			is_tribal = no
			is_nomadic = no
		}
	}
}
feudal_group_allow_trigger = {}

# Chinese Imperial
chinese_imperial_government_potential_trigger = {
	trigger_if = {
		limit = {
			NOT = { has_character_flag = chinese_imperial_government_preserve } # keeps government when player is given culture change opton
		}

		OR = {
			culture_group = chinese_group
			culture = khitan
			culture = tangut
			culture = jurchen
		}
	}

	primary_title = {
		real_tier = EMPEROR
		has_title_flag = pretender_chinese_empire
	}
}
chinese_imperial_government_allow_trigger = {}

# Feudal
feudal_government_potential_trigger = {
	# Other Feudals
	muslim_government_potential_trigger = no
	theocratic_feudal_government_potential_trigger = no

	# Segregate the rule breakers
	chinese_imperial_government_potential_trigger = no
	order_government_potential_trigger = no
	roman_imperial_government_potential_trigger = no
}
feudal_government_allow_trigger = {}

# Iqta
muslim_government_potential_trigger = {
	religion_group = muslim

	# Segregate the rule breakers
	chinese_imperial_government_potential_trigger = no
	order_government_potential_trigger = no
	roman_imperial_government_potential_trigger = no
}
muslim_government_allow_trigger = {}

# Holy Orders
order_government_potential_trigger = {
	# Don't play with bishops, always
	OR = {
		is_tribal = yes
		is_feudal = yes
	}

	trigger_if = {
		limit = { holy_order = no }

		ai = yes

		any_liege = {
			holy_order = yes
			religion = ROOT
		}

		NOT = { is_government_potential = merchant_republic_government }
	}
}
order_government_allow_trigger = {}

# Imperial Roman
roman_imperial_government_potential_trigger = {
	trigger_if = {
		limit = {
			has_game_started = no
			is_save_game = no
		}

		primary_title = {
			OR = {
				title = e_roman_empire
				title = e_byzantium
			}
		}
	}
	trigger_else = {
		primary_title = { has_law = succ_byzantine_elective }
	}
}
roman_imperial_government_allow_trigger = {}

# Theocratic Feudal
theocratic_feudal_government_potential_trigger = {
	higher_real_tier_than = BARON # barons should use Theocracy instead

	culture_group = tibetan_group

	OR = {
		religion_openly_bon_or_reformed_trigger = yes
		religion = buddhist
	}

	# Segregate the rule breakers
	chinese_imperial_government_potential_trigger = no
	order_government_potential_trigger = no
	roman_imperial_government_potential_trigger = no
}
theocratic_feudal_government_allow_trigger = {}

# Nomadic Group
# In case someone wants to add more Nomads for some reason
nomadic_group_potential_trigger = {
	order_government_potential_trigger = no
	is_patrician = no
	mercenary = no

	trigger_if = {
		limit = { controls_religion = yes }

		temporal_religious_head_trigger = yes
	}
}
nomadic_group_allow_trigger = {
	# Prevents spontaneous Nomad Spread
	trigger_if = {
		limit = { has_game_started = yes }

		is_feudal = no
		is_republic = no
		is_theocracy = no
		is_tribal = no
	}
	# Keeps Nomads from showing up in Tribal areas on ruler selection
	trigger_else = {
		capital_scope = { has_tribal = no }
	}
}

# Nomad Government
nomadic_government_potential_trigger = {}
nomadic_government_allow_trigger = {}

# Republic Group
republic_group_potential_trigger = {

	# Ironically, the Confucians don't play by the rules
	trigger_if = {
		limit = { confucian_government_potential_trigger = no }

		# Religion Heads
		trigger_if = {
			limit = { controls_religion = yes }

			temporal_religious_head_trigger = yes
		}

		# Keep Tribes and Nomads from instant-switching to Feudal/Republican
		trigger_if = {
			limit = { has_game_started = yes }

			is_tribal = no
			is_nomadic = no
		}
	}
}
republic_group_allow_trigger = {}

# Confucian Bureaucracy
confucian_government_potential_trigger = {
	is_offmap_tag = offmap_china
}
confucian_government_allow_trigger = {}

# Merchant Republic
merchant_republic_government_potential_trigger = {
	# Make Sure China is always Confucian
	confucian_government_potential_trigger = no

	# Patrician and Doge requirements
	OR = {
		# Doge requirements
		# Does not require being a patrician, to allow creation of new Merchant Republics
		AND = {
			# Must always be coastal
			capital_scope = { is_coastal = yes }

			# Require at least one province and be Duke tier or higher
			higher_real_tier_than = COUNT
			num_of_count_titles >= 1

			# MR can't be under MR
			trigger_if = {
				limit = { independent = no }

				liege_before_war = {
					is_merchant_republic = no
				}
			}
		}

		# Patrician requirements
		AND = {
			is_patrician = yes

			# Liege must be MR
			liege_before_war = {
				is_merchant_republic = yes

				# MR can't be under MR
				trigger_if = {
					limit = { independent = no }

					liege_before_war = {
						is_merchant_republic = no
					}
				}
			}
		}
	}
}
merchant_republic_government_allow_trigger = {}

# Republic Government
republic_government_potential_trigger = {
	confucian_government_potential_trigger = no
	merchant_republic_government_potential_trigger = no
}
republic_government_allow_trigger = {}

# Theocratic Group
# In case someone wants to add more Theocracies for some reason
theocratic_group_potential_trigger = {
	# Universal Rules
	is_patrician = no
	muslim_government_potential_trigger = no
	order_government_potential_trigger = no

	# Gender Considerations
	trigger_if = {
		limit = { is_female = yes }
		religion_allows_female_temple_holders = yes
	}
	trigger_else = {
		religion_allows_male_temple_holders = yes
	}

	# Religion Heads
	trigger_if = {
		limit = { controls_religion = yes }

		temporal_religious_head_trigger = no
	}
	# Everything BUT the Religion Head
	trigger_else = {
		theocratic_feudal_government_potential_trigger = no # Theocratic Feudal religion head is still Theocratic
	}
}
theocratic_group_allow_trigger = {
	trigger_if = {
		limit = { has_game_started = yes }

		# is_theocracy = yes # This apparently causes issues, have to do it the long way instead
		is_feudal = no
		is_nomadic = no
		is_tribal = no
		is_republic = no
	}
}

# Theocracy Government
theocratic_government_potential_trigger = {}
theocratic_government_allow_trigger = {}

# Tribal Group
# In case someone wants to add more Tribals for some reason
tribal_group_potential_trigger = {
	is_patrician = no
	mercenary = no
	order_government_potential_trigger = no

	trigger_if = {
		limit = { controls_religion = yes }

		temporal_religious_head_trigger = yes
	}
}
tribal_group_allow_trigger = {
	trigger_if = {
		limit = { has_game_started = yes }

		# is_tribal = yes # See above for the Theocracies, I suspect there is a similar problem here
		is_feudal = no
		is_nomadic = no
		is_theocracy = no
		is_republic = no
	}
	trigger_else = {
		capital_scope = { has_tribal = yes } # I don't know why this works but it does and I'm not going to question it
	}
}

# Tribal Government
tribal_government_potential_trigger = {}
tribal_government_allow_trigger = {}
