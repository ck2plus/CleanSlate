##########################################
#
# Furusiyya Tournament Events
#
# Event ID 88250 - 88499 is reserved
#
##########################################

# Invitation
character_event = {
	id = 88250
	title = FURUSIYYATITLE
	desc = EVTDESC88250
	picture = GFX_evt_emissary_arabic

	is_triggered_only = yes

	trigger = { is_inaccessible_trigger = no }

	option = {
		name = EVTOPTA88250

		prestige = 50
		set_character_flag = attending_tournament_furusiyya
		set_character_flag = do_not_disturb

		ai_chance = { factor = 100 }
	}

	option = {
		name = EVTOPTB88250

		prestige = -100

		ai_chance = { factor = 0.1 }
	}
}

# Start of tournament
character_event = {
	id = 88251
	title = FURUSIYYATITLE
	desc = EVTDESC88251
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	war = no

	option = {
		name = EVTOPTA88251

		hidden_effect = {
			set_character_flag = attending_tournament_furusiyya

			chronicle = {
				entry = CHRONICLE_FURUSIYYA
				picture = GFX_evt_joust
			}

			# Injuries
			any_realm_character = {
				limit = { has_character_flag = attending_tournament_furusiyya }

				character_event = {
					id = 88450 # random occurrence for attendees
					days = 2
					random = 40
				}

				# Set score
				character_event = {
					id = 88460
					days = 46
				}
			}

			# Select winner
			character_event = {
				id = 88461
				days = 48
			}

			# Select runner up
			character_event = {
				id = 88462
				days = 49
			}

			# Select third place
			character_event = {
				id = 88463
				days = 50
			}

			# Notify winners
			character_event = {
				id = 88464
				days = 51
			}
		}
	}
}

# Tournament called off due to war
character_event = {
	id = 88293

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		ROOT = {
			if = {
				limit = { has_character_flag = epic_tournament_furusiyya }
				character_event = { id = 88294 }
			}
		}

		FROM = {
			if = {
				limit = { has_character_flag = epic_tournament_furusiyya }
				character_event = { id = 88294 }
			}
		}
	}
}

# Tournament called off due to war - ruler
character_event = {
	id = 88294
	title = FURUSIYYATITLE
	desc = EVTDESC88287
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTB88251

		wealth = 200
		prestige = -100
		decadence = 5

		hidden_effect = {
			any_realm_character = {
				limit = { has_character_flag = attending_tournament }
				character_event = { id = 88287 }
			}

			remove_character_modifier = epic_tournament_furusiyya
			clear_delayed_event = { id = 88251 }
			clear_delayed_event = { id = 88450 }
			clear_delayed_event = { id = 88460 }
			clear_delayed_event = { id = 88461 }
			clear_delayed_event = { id = 88462 }
			clear_delayed_event = { id = 88463 }
			clear_delayed_event = { id = 88464 }
			clr_character_flag = epic_tournament_furusiyya
			clr_character_flag = attending_tournament_furusiyya
			clr_character_flag = do_not_disturb
			clr_character_flag = no_msg_death_furusiyya
			clr_character_flag = no_msg_maimed_furusiyya
			clr_character_flag = no_msg_wounded_furusiyya
			clr_character_flag = tournament_has_ended_furusiyya
			clr_character_flag = tournament_third_place_furusiyya
			clr_character_flag = tournament_second_place_furusiyya
			clr_character_flag = tournament_winner_furusiyya
		}
	}
}

# Tournament has been cancelled - guest
character_event = {
	id = 88287
	title = FURUSIYYATITLE
	desc = EVTDESC88287
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88287

		prestige = -50
		clr_character_flag = attending_tournament_furusiyya
		clr_character_flag = do_not_disturb
		clr_character_flag = tournament_third_place_furusiyya
		clr_character_flag = tournament_second_place_furusiyya
		clr_character_flag = tournament_winner_furusiyya
		clear_delayed_event = { id = 88284 }
		clear_delayed_event = { id = 88285 }
		clear_delayed_event = { id = 88286 }
		clear_delayed_event = { id = 88450 }
		clear_delayed_event = { id = 88460 }
	}
}

# Message about death
character_event = {
	id = 88288
	title = FURUSIYYATITLE
	desc = EVTDESC88288
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = {
		NOT = { has_character_flag = no_msg_death_furusiyya }
	}

	option = {
		name = EVTOPTA88288
	}

	option = {
		name = EVTOPTB88288

		set_character_flag = no_msg_death_furusiyya
	}
}

# Message about maimed
character_event = {
	id = 88289
	title = FURUSIYYATITLE
	desc = EVTDESC88289
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = {
		NOT = { has_character_flag = no_msg_maimed_furusiyya }
	}

	option = {
		name = EVTOPTA88289
	}

	option = {
		name = EVTOPTB88289

		set_character_flag = no_msg_maimed_furusiyya
	}
}

# Message about wounded
character_event = {
	id = 88290
	title = FURUSIYYATITLE
	desc = EVTDESC88290
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = {
		NOT = { has_character_flag = no_msg_wounded_furusiyya }
	}

	option = {
		name = EVTOPTA88290
	}

	option = {
		name = EVTOPTB88290

		set_character_flag = no_msg_wounded_furusiyya
	}
}

# Tournament is over
character_event = {
	id = 88252
	title = FURUSIYYATITLE
	desc = EVTDESC88252
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88252

		custom_tooltip = {
			text = EVTOPTA70002_TOOLTIP

			clr_character_flag = attending_tournament_furusiyya
			clr_character_flag = do_not_disturb
			clr_character_flag = tournament_third_place_furusiyya
			clr_character_flag = tournament_second_place_furusiyya
			clr_character_flag = tournament_winner_furusiyya
			clr_character_flag = epic_tournament_furusiyya

			any_realm_character = {
				limit = { has_character_flag = attending_tournament_furusiyya }

				clr_character_flag = attending_tournament_furusiyya
				clr_character_flag = do_not_disturb

				opinion = {
					name = opinion_tournament_participant
					who = PREV
					years = 5
				}

				if = {
					limit = {
						OR = {
							has_character_flag = tournament_third_place_furusiyya
							has_character_flag = tournament_second_place_furusiyya
							has_character_flag = tournament_winner_furusiyya
						}
					}

					clr_character_flag = tournament_third_place_furusiyya
					clr_character_flag = tournament_second_place_furusiyya
					clr_character_flag = tournament_winner_furusiyya
				}
				else_if = {
					limit = {
						NOT = { character = ROOT }
					}

					random_list = {
						10 = { character_event = { id = 88253 } }
						10 = { character_event = { id = 88254 } }
						10 = { character_event = { id = 88255 } }
						10 = { character_event = { id = 88256 } }
						10 = { character_event = { id = 88257 } }
						10 = { character_event = { id = 88258 } }
					}

					clr_character_flag = tourney_score_15
					clr_character_flag = tourney_score_14
					clr_character_flag = tourney_score_13
					clr_character_flag = tourney_score_12
					clr_character_flag = tourney_score_11
					clr_character_flag = tourney_score_10
					clr_character_flag = tourney_score_09
					clr_character_flag = tourney_score_08
					clr_character_flag = tourney_score_07
					clr_character_flag = tourney_score_06
					clr_character_flag = tourney_score_05
					clr_character_flag = tourney_score_04
					clr_character_flag = tourney_score_03
					clr_character_flag = tourney_score_02
					clr_character_flag = tourney_score_01
					clr_character_flag = tourney_score_00
				}
			}
		}

		if = {
			limit = { has_dlc = "Reapers" }

			custom_tooltip = {
				text = capital_prospers_custom_tooltip

				capital_scope = {
					change_variable = {
						which = prosperity_value
						value = 15
					}
				}
			}
		}
	}
}

# End of tournament event
character_event = {
	id = 88253
	title = FURUSIYYATITLE
	desc = EVTDESC88253
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88253

		prestige = 50
	}
}

# End of tournament event
character_event = {
	id = 88254
	title = FURUSIYYATITLE
	desc = EVTDESC88254
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88254

		prestige = 100
	}
}

# End of tournament event
character_event = {
	id = 88255
	title = FURUSIYYATITLE
	desc = EVTDESC88255
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88255

		prestige = -50
	}
}

# End of tournament event
character_event = {
	id = 88256
	title = FURUSIYYATITLE
	desc = EVTDESC88256
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88256

		prestige = -100
	}
}

# End of tournament event
character_event = {
	id = 88257
	title = FURUSIYYATITLE
	desc = EVTDESC88257
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88257

		change_martial = 1
	}
}

# End of tournament event
character_event = {
	id = 88258
	title = FURUSIYYATITLE
	desc = EVTDESC88258
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88258

		change_martial = -1
	}
}

# Character is killed
character_event = {
	id = 88259
	title = FURUSIYYATITLE
	desc = EVTDESC88259
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88259

		death = { death_reason = death_battle }

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 88288 }
			}
		}
	}
}

# Character is maimed
character_event = {
	id = 88260
	title = FURUSIYYATITLE
	desc = EVTDESC88260
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		clr_character_flag = attending_tournament_furusiyya
	}

	option = {
		name = EVTOPTA88260

		add_maimed_trait_effect = yes

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 88289 }
			}
		}
	}
}

# Character is wounded
character_event = {
	id = 88261
	title = FURUSIYYATITLE
	desc = EVTDESC88261
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88261

		add_trait = wounded

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 88290 }
			}
		}
	}
}

# Character becomes craven
character_event = {
	id = 88262
	title = FURUSIYYATITLE
	desc = EVTDESC88262
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88262

		add_trait_fully_silently_craven_effect = yes
	}
}

# Character becomes brave
character_event = {
	id = 88263
	title = FURUSIYYATITLE
	desc = EVTDESC88263
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88263

		add_trait_fully_silently_brave_effect = yes
	}
}

# Character becomes tough soldier
character_event = {
	id = 88264
	title = FURUSIYYATITLE
	desc = EVTDESC88264
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88264

		remove_trait = misguided_warrior
		add_trait = tough_soldier
	}
}

# Character becomes skilled tactician
character_event = {
	id = 88265
	title = FURUSIYYATITLE
	desc = EVTDESC88265
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88265

		remove_trait = tough_soldier
		add_trait = skilled_tactician
	}
}

# Character becomes brilliant strategist
character_event = {
	id = 88266
	title = FURUSIYYATITLE
	desc = EVTDESC88266
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88266

		remove_trait = skilled_tactician
		add_trait = brilliant_strategist
	}
}

# Character becomes skilled tactician
character_event = {
	id = 88267
	title = FURUSIYYATITLE
	desc = EVTDESC88267
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88267

		remove_trait = brilliant_strategist
		add_trait = skilled_tactician
	}
}

# Character becomes tough soldier
character_event = {
	id = 88268
	title = FURUSIYYATITLE
	desc = EVTDESC88268
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88268

		remove_trait = skilled_tactician
		add_trait = tough_soldier
	}
}

# Character becomes misguided warrior
character_event = {
	id = 88269
	title = FURUSIYYATITLE
	desc = EVTDESC88269
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88269

		remove_trait = tough_soldier
		add_trait = misguided_warrior
	}
}

# Character gets top 3
character_event = {
	id = 88270
	title = FURUSIYYATITLE
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	desc = {
		text = EVTDESC88270
		trigger = { has_character_flag = tournament_winner_furusiyya }
	}
	desc = {
		text = EVTDESC88271
		trigger = { has_character_flag = tournament_second_place_furusiyya }
	}
	desc = {
		text = EVTDESC88272
		trigger = { has_character_flag = tournament_third_place_furusiyya }
	}

	is_triggered_only = yes

	min_age = 16
	only_men = yes
	only_capable = yes
	prisoner = no

	option = {
		name = EVTOPTA88270

		trigger = { has_character_flag = tournament_winner_furusiyya }

		wealth = 100
		prestige = 300

		if = {
			limit = {
				uses_decadence = yes
				NOT = { dynasty = top_liege }
			}

			decadence = -3
		}

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 88284
					days = 3
				}
			}
		}

		any_player = {
			limit = {
				dynasty = ROOT
				NOT = { character = ROOT }
			}

			character_event = { id = 88301 }
		}
	}

	option = {
		name = EVTOPTA88271

		trigger = { has_character_flag = tournament_second_place_furusiyya }

		wealth = 75
		prestige = 250

		if = {
			limit = {
				uses_decadence = yes
				NOT = { dynasty = top_liege }
			}

			decadence = -2
		}

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 88285
					days = 2
				}
			}
		}

		any_player = {
			limit = {
				dynasty = ROOT
				NOT = { character = ROOT }
			}

			character_event = { id = 88302 }
		}
	}

	option = {
		name = EVTOPTA88272

		trigger = { has_character_flag = tournament_third_place_furusiyya }

		wealth = 50
		prestige = 200

		if = {
			limit = {
				uses_decadence = yes
				NOT = { dynasty = top_liege }
			}

			decadence = -1
		}

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 88286
					days = 1
				}
			}
		}

		any_player = {
			limit = {
				dynasty = ROOT
				NOT = { character = ROOT }
			}

			character_event = { id = 88303 }
		}
	}
}

# Inform about winner
character_event = {
	id = 88284
	title = FURUSIYYATITLE
	desc = EVTDESC88284
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88284

		opinion = {
			name = opinion_tournament_winner
			who = FROM
			years = 20
		}

		if = {
			limit = { dynasty = FROM }
			decadence = -3
		}

		character_event = { id = 88252 }
	}
}

# Inform about second place
character_event = {
	id = 88285
	title = FURUSIYYATITLE
	desc = EVTDESC88285
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88285

		opinion = {
			name = opinion_tournament_second_place
			who = FROM
			years = 15
		}

		if = {
			limit = { dynasty = FROM }
			decadence = -2
		}
	}
}

# Inform about third place
character_event = {
	id = 88286
	title = FURUSIYYATITLE
	desc = EVTDESC88286
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88286

		opinion = {
			name = opinion_tournament_third_place
			who = FROM
			years = 10
		}

		if = {
			limit = { dynasty = FROM }
			decadence = -1
		}
	}
}

# Character becomes homosexual
character_event = {
	id = 88273
	title = FURUSIYYATITLE
	desc = EVTDESC88273
	picture = GFX_evt_lunatic_arabic
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88273

		add_trait = homosexual
	}
}

# Character gains great_pox
character_event = {
	id = 88274
	title = FURUSIYYATITLE
	desc = EVTDESC88274
	picture = GFX_evt_sultan
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88274

		give_great_pox_effect = yes
	}
}

# Character becomes drunkard
character_event = {
	id = 88275
	title = FURUSIYYATITLE
	desc = EVTDESC88275
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88275

		add_trait = drunkard
	}
}

# Character becomes duelist
character_event = {
	id = 88276
	title = FURUSIYYATITLE
	desc = EVTDESC88276
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88276

		add_trait = duelist
	}
}

# Character gains intrigue
character_event = {
	id = 88277
	title = FURUSIYYATITLE
	desc = EVTDESC88277
	picture = GFX_evt_whispers
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88277

		change_intrigue = 1
	}
}

# Character loses intrigue
character_event = {
	id = 88278
	title = FURUSIYYATITLE
	desc = EVTDESC88278
	picture = GFX_evt_whispers
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88278

		change_intrigue = -1
	}
}

# Character gains stewardship
character_event = {
	id = 88279
	title = FURUSIYYATITLE
	desc = EVTDESC88279
	picture = GFX_evt_market
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88279

		change_stewardship = 1
	}
}

# Character loses stewardship
character_event = {
	id = 88280
	title = FURUSIYYATITLE
	desc = EVTDESC88280
	picture = GFX_evt_market
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88280

		change_stewardship = -1
	}
}

# Character gains diplomacy
character_event = {
	id = 88281
	title = FURUSIYYATITLE
	desc = EVTDESC88281
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88281

		change_diplomacy = 1
	}
}

# Character loses diplomacy
character_event = {
	id = 88282
	title = FURUSIYYATITLE
	desc = EVTDESC88282
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA88282

		change_diplomacy = -1
	}
}

# Invitations have gone out
character_event = {
	id = 88283
	title = FURUSIYYATITLE
	desc = EVTDESC88283
	picture = GFX_evt_moors
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EXCELLENT

		hidden_effect = {
			character_event = {
				id = 88251 # Tournament start
				days = 60
			}

			any_realm_character = {
				limit = {
					OR = {
						is_feudal = yes
						is_tribal = yes
						is_nomadic = yes
					}

					is_female = no
					is_adult = yes
					practical_age < 50
					is_incapable = no
					prisoner = no
					NOT = { has_job_title = job_spiritual }
					is_inaccessible_trigger = no
				}

				character_event = { id = 88250 }
			}

			any_player = {
				limit = {
					dynasty = ROOT
					NOT = { character = ROOT }
				}

				character_event = { id = 88300 }
			}
		}
	}
}

# Ruler has died, the tournament is over
character_event = {
	id = 88291
	title = FURUSIYYATITLE
	desc = EVTDESC88291
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes # on_death

	trigger = { has_character_flag = epic_tournament_furusiyya }

	immediate = {
		clr_character_flag = attending_tournament_furusiyya
		clr_character_flag = tournament_third_place_furusiyya
		clr_character_flag = tournament_second_place_furusiyya
		clr_character_flag = tournament_winner_furusiyya
		clr_character_flag = do_not_disturb
		clear_delayed_event = { id = 88251 }
		clear_delayed_event = { id = 88450 }
		clear_delayed_event = { id = 88460 }
		clear_delayed_event = { id = 88461 }
		clear_delayed_event = { id = 88462 }
		clear_delayed_event = { id = 88463 }
		clear_delayed_event = { id = 88464 }

		any_realm_character = {
			limit = { has_character_flag = attending_tournament_furusiyya }

			letter_event = {
				id = 88292 # Inform of tournament cancellation
				days = 2
				random = 2
			}

			clr_character_flag = tournament_third_place_furusiyya
			clr_character_flag = tournament_second_place_furusiyya
			clr_character_flag = tournament_winner_furusiyya
			clr_character_flag = attending_tournament_furusiyya
			clr_character_flag = do_not_disturb
			clear_delayed_event = { id = 88284 }
			clear_delayed_event = { id = 88285 }
			clear_delayed_event = { id = 88286 }
			clear_delayed_event = { id = 88450 }
			clear_delayed_event = { id = 88460 }
		}
	}

	option = {
		name = EVTOPTA88291
	}
}

# The tournament has been cancelled due to Ruler's death
letter_event = {
	id = 88292
	title = FURUSIYYATITLE
	desc = EVTDESC88292

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA88292
	}
}

### Decadence notifications

# Furusiyya held
character_event = {
	id = 88300
	desc = EVTDESC88300
	picture = GFX_evt_joust_arabic
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA88300
	}
}

# Tournament Winner
character_event = {
	id = 88301
	desc = EVTDESC88301
	picture = GFX_evt_joust_arabic
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA88301
	}
}

# Tournament Second Place
character_event = {
	id = 88302
	desc = EVTDESC88302
	picture = GFX_evt_joust_arabic
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA88302
	}
}

# Tournament Third Place
character_event = {
	id = 88303
	desc = EVTDESC88303
	picture = GFX_evt_joust_arabic
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA88303
	}
}

# Tournament attender event for random occurences
character_event = {
	id = 88450

	is_triggered_only = yes
	hide_window = yes

	min_age = 16
	only_men = yes
	only_capable = yes
	prisoner = no

	immediate = {
		random_list = {
			10 = { # character is killed
				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				mult_modifier = {
					factor = 2
					is_maimed_trigger = yes
				}

				character_event = { id = 88259 }
			}

			13 = { # character maimed
				trigger = { can_be_maimed_trigger = yes }

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				character_event = { id = 88260 }
			}

			20 = { # character wounded
				trigger = {
					is_maimed_trigger = no
					NOT = { trait = wounded }
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				character_event = { id = 88261 }
			}

			40 = { # gain craven
				trigger = {
					NOR = {
						trait = craven
						trait = berserker
					}
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				character_event = { id = 88262 }
			}

			40 = { # gain brave
				trigger = {
					NOT = { trait = brave }
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 0.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 0.5
					combat_rating < 0
				}

				character_event = { id = 88263 }
			}

			40 = { # promoted to tough soldier
				trigger = { trait = misguided_warrior }

				character_event = { id = 88264 }
			}

			40 = { # promoted to skilled tactician
				trigger = { trait = tough_soldier }

				character_event = { id = 88265 }
			}

			40 = { # promoted to brilliant strategist
				trigger = { trait = skilled_tactician }

				character_event = { id = 88266 }
			}

			40 = { # demoted to skilled tactician
				trigger = { trait = brilliant_strategist }

				character_event = { id = 88267 }
			}

			40 = { # demoted to tough soldier
				trigger = { trait = skilled_tactician }

				character_event = { id = 88268 }
			}

			40 = { # demoted to misguided warrior
				trigger = { trait = tough_soldier }

				character_event = { id = 88269 }
			}

			13 = { # gain homosexual
				trigger = {
					NOR = {
						trait = homosexual
						trait = celibate
						trait = eunuch
					}
				}

				mult_modifier = {
					factor = 1.2
					trait = drunkard
				}

				mult_modifier = {
					factor = 1.5
					trait = hedonist
				}

				mult_modifier = {
					factor = 1.2
					trait = lustful
				}

				mult_modifier = {
					factor = 0.5
					trait = temperate
				}

				mult_modifier = {
					factor = 0.3
					trait = chaste
				}

				mult_modifier = {
					factor = 0.3
					trait = zealous
				}

				character_event = { id = 88273 }
			}

			13 = { # gain great_pox
				trigger = {
					NOR = {
						trait = great_pox
						trait = celibate
						trait = eunuch
						has_character_flag = developing_illness
						has_character_flag = disease_not_serious
					}
				}

				mult_modifier = {
					factor = 1.2
					trait = drunkard
				}

				mult_modifier = {
					factor = 1.5
					trait = hedonist
				}

				mult_modifier = {
					factor = 1.2
					trait = lustful
				}

				mult_modifier = {
					factor = 0.5
					trait = temperate
				}

				mult_modifier = {
					factor = 0.3
					trait = chaste
				}

				mult_modifier = {
					factor = 0.3
					trait = zealous
				}

				character_event = { id = 88274 }
			}

			20 = { # gain drunkard
				trigger = {
					NOT = { trait = drunkard }
				}

				mult_modifier = {
					factor = 1.3
					trait = gluttonous
				}

				mult_modifier = {
					factor = 1.1
					trait = lustful
				}

				mult_modifier = {
					factor = 0.3
					trait = temperate
				}

				mult_modifier = {
					factor = 0.5
					trait = chaste
				}

				character_event = { id = 88275 }
			}

			20 = { # gain duelist
				trigger = {
					lifestyle_traits < 1
					martial >= 5
					is_weak_trigger = no

					NOR = {
						has_dlc = "Way of Life"
						trait = content
						trait = kind
						trait = craven
					}
				}

				mult_modifier = {
					factor = 1.3
					trait = diligent
				}

				mult_modifier = {
					factor = 1.3
					trait = wroth
				}

				mult_modifier = {
					factor = 1.3
					trait = brave
				}

				mult_modifier = {
					factor = 1.3
					is_strong_trigger = yes
				}

				mult_modifier = {
					factor = 1.3
					martial >= 10
				}

				mult_modifier = {
					factor = 1.3
					martial >= 15
				}

				mult_modifier = {
					factor = 1.3
					martial >= 20
				}

				character_event = { id = 88276 }
			}

			40 = { # increase intrigue
				mult_modifier = {
					factor = 1.2
					trait = elusive_shadow
				}

				mult_modifier = {
					factor = 1.1
					trait = intricate_webweaver
				}

				mult_modifier = {
					factor = 0.9
					trait = flamboyant_schemer
				}

				mult_modifier = {
					factor = 0.7
					trait = amateurish_plotter
				}

				mult_modifier = {
					factor = 0.7
					has_education_intrigue_trigger = no
				}

				mult_modifier = {
					factor = 1.1
					trait = deceitful
				}

				mult_modifier = {
					factor = 0.7
					trait = honest
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 88277 }
			}

			40 = { # decrease intrigue
				mult_modifier = {
					factor = 0.8
					trait = elusive_shadow
				}

				mult_modifier = {
					factor = 0.9
					trait = intricate_webweaver
				}

				mult_modifier = {
					factor = 1.1
					trait = flamboyant_schemer
				}

				mult_modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}

				mult_modifier = {
					factor = 0.7
					has_education_intrigue_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = deceitful
				}

				mult_modifier = {
					factor = 1.5
					trait = honest
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 88278 }
			}

			40 = { # increase stewardship
				mult_modifier = {
					factor = 1.5
					trait = midas_touched
				}

				mult_modifier = {
					factor = 1.1
					trait = fortune_builder
				}

				mult_modifier = {
					factor = 0.9
					trait = thrifty_clerk
				}

				mult_modifier = {
					factor = 0.8
					trait = indulgent_wastrel
				}

				mult_modifier = {
					factor = 0.7
					has_education_stewardship_trigger = no
				}

				mult_modifier = {
					factor = 1.5
					trait = diligent
				}

				mult_modifier = {
					factor = 0.9
					trait = slothful
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 88279 }
			}

			40 = { # decrease stewardship
				mult_modifier = {
					factor = 0.8
					trait = midas_touched
				}

				mult_modifier = {
					factor = 0.9
					trait = fortune_builder
				}

				mult_modifier = {
					factor = 1.1
					trait = thrifty_clerk
				}

				mult_modifier = {
					factor = 1.5
					trait = indulgent_wastrel
				}

				mult_modifier = {
					factor = 0.7
					has_education_stewardship_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = diligent
				}

				mult_modifier = {
					factor = 1.5
					trait = slothful
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 88280 }
			}

			40 = { # increase diplomacy
				mult_modifier = {
					factor = 1.5
					trait = grey_eminence
				}

				mult_modifier = {
					factor = 1.1
					trait = charismatic_negotiator
				}

				mult_modifier = {
					factor = 0.9
					trait = underhanded_rogue
				}

				mult_modifier = {
					factor = 0.8
					trait = naive_appeaser
				}

				mult_modifier = {
					factor = 0.7
					has_education_diplomacy_trigger = no
				}

				mult_modifier = {
					factor = 1.5
					trait = gregarious
				}

				mult_modifier = {
					factor = 0.9
					trait = shy
				}

				character_event = { id = 88281 }
			}

			40 = { # decrease diplomacy
				mult_modifier = {
					factor = 0.8
					trait = grey_eminence
				}

				mult_modifier = {
					factor = 0.9
					trait = charismatic_negotiator
				}

				mult_modifier = {
					factor = 1.1
					trait = underhanded_rogue
				}

				mult_modifier = {
					factor = 1.5
					trait = naive_appeaser
				}

				mult_modifier = {
					factor = 0.7
					has_education_diplomacy_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = gregarious
				}

				mult_modifier = {
					factor = 1.5
					trait = shy
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 88282 }
			}

			1000 = { }
		}
	}
}


###########################################
# SCORING, LOOK AWAY FRAGILE EYES		#
###########################################

character_event = {
	id = 88460

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		random_list = {
			10 = {
				trigger = { combat_rating >= 130 }

				set_character_flag = tourney_score_15
			}

			10 = {
				trigger = {
					combat_rating >= 120
					combat_rating < 170
				}

				set_character_flag = tourney_score_14
			}

			10 = {
				trigger = {
					combat_rating >= 110
					combat_rating < 160
				}

				set_character_flag = tourney_score_13
			}

			10 = {
				trigger = {
					combat_rating >= 100
					combat_rating < 150
				}

				set_character_flag = tourney_score_12
			}

			10 = {
				trigger = {
					combat_rating >= 90
					combat_rating < 140
				}

				set_character_flag = tourney_score_11
			}

			10 = {
				trigger = {
					combat_rating >= 80
					combat_rating < 130
				}

				set_character_flag = tourney_score_10
			}

			10 = {
				trigger = {
					combat_rating >= 70
					combat_rating < 120
				}

				set_character_flag = tourney_score_09
			}

			10 = {
				trigger = {
					combat_rating >= 60
					combat_rating < 110
				}

				set_character_flag = tourney_score_08
			}

			10 = {
				trigger = {
					combat_rating >= 50
					combat_rating < 100
				}

				set_character_flag = tourney_score_07
			}

			10 = {
				trigger = {
					combat_rating >= 40
					combat_rating < 90
				}

				set_character_flag = tourney_score_06
			}

			10 = {
				trigger = {
					combat_rating >= 30
					combat_rating < 80
				}

				set_character_flag = tourney_score_05
			}

			10 = {
				trigger = {
					combat_rating >= 20
					combat_rating < 70
				}

				set_character_flag = tourney_score_04
			}

			10 = {
				trigger = {
					combat_rating >= 10
					combat_rating < 60
				}

				set_character_flag = tourney_score_03
			}

			10 = {
				trigger = { combat_rating < 50 }

				set_character_flag = tourney_score_02
			}

			10 = {
				trigger = { combat_rating < 40 }

				set_character_flag = tourney_score_01
			}

			10 = {
				trigger = { combat_rating < 30 }

				set_character_flag = tourney_score_00
			}
		}
	}
}

###########################################
# First place WINNER!				#
###########################################

character_event = {
	id = 88461

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_winner_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_winner_furusiyya
		}
	}
}

###########################################
# Second place							#
###########################################

character_event = {
	id = 88462

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_second_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_second_place_furusiyya
		}
	}
}

###########################################
# Third place							#
###########################################

character_event = {
	id = 88463

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_third_place_furusiyya
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_third_place_furusiyya
		}
	}
}

###########################################
# Notify winners						#
###########################################

character_event = {
	id = 88464

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		any_realm_character = {
			limit = {
				OR = {
					has_character_flag = tournament_winner_furusiyya
					has_character_flag = tournament_second_place_furusiyya
					has_character_flag = tournament_third_place_furusiyya
				}
			}

			character_event = { id = 88270 }
		}
	}
}

###########################################
# Flag management						#
###########################################

# Safety catch - clears character flags and modifiers - removed by CleanSlate