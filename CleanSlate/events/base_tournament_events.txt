################################################
#
# Events for Tournament
#
# ID 70000 - 70999 is reserved
#
#################################################
#
# Written by Chris King
#
# Rewritten by Niklas Strid
# And again by Markus Olsen

# Invitation
character_event = {
	id = 70000
	title = TOURNAMENTTITLE
	desc = EVTDESC70000
	picture = GFX_evt_courier

	is_triggered_only = yes

	option = {
		name = EVTOPTA70000

		prestige = 50
		set_character_flag = attending_tournament
		set_character_flag = do_not_disturb

		ai_chance = { factor = 100 }
	}

	option = {
		name = EVTOPTB70000

		ai_chance = { factor = 0.1 }
	}
}

# Start of tournament
character_event = {
	id = 70001
	title = TOURNAMENTTITLE
	desc = EVTDESC70001
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	war = no

	option = {
		name = EVTOPTA70001

		set_character_flag = attending_tournament

		chronicle = {
			entry = CHRONICLE_GRAND_TOURNAMENT
			picture = GFX_evt_joust
		}

		# Injuries
		any_realm_character = {
			limit = { has_character_flag = attending_tournament }

			character_event = {
				id = 70050 # random occurrence for attendees
				days = 2
				random = 40
			}

			# Set score
			character_event = {
				id = 70060
				days = 46
			}
		}

		# Select winner
		character_event = {
			id = 70061
			days = 48
		}

		# Select runner up
		character_event = {
			id = 70062
			days = 49
		}

		# Select third place
		character_event = {
			id = 70063
			days = 50
		}

		# Notify winners
		character_event = {
			id = 70064
			days = 51
		}
	}
}

# Tournament called off due to war
character_event = {
	id = 70043

	hide_window = yes
	is_triggered_only = yes # on_war_started

	immediate = {
		ROOT = {
			if = {
				limit = { has_character_flag = epic_tournament }
				character_event = { id = 70044 }
			}
		}

		FROM = {
			if = {
				limit = { has_character_flag = epic_tournament }
				character_event = { id = 70044 }
			}
		}
	}
}

# Tournament called off due to war - ruler
character_event = {
	id = 70044
	title = TOURNAMENTTITLE
	desc = EVTDESC70037
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		remove_character_modifier = epic_tournament
		clear_delayed_event = { id = 70001 }
		clear_delayed_event = { id = 70050 }
		clear_delayed_event = { id = 70060 }
		clear_delayed_event = { id = 70061 }
		clear_delayed_event = { id = 70062 }
		clear_delayed_event = { id = 70063 }
		clear_delayed_event = { id = 70064 }
		clr_character_flag = epic_tournament
		clr_character_flag = attending_tournament
		clr_character_flag = do_not_disturb
		clr_character_flag = no_msg_death
		clr_character_flag = no_msg_maimed
		clr_character_flag = no_msg_wounded
		clr_character_flag = tournament_winner
		clr_character_flag = tournament_second_place
		clr_character_flag = tournament_third_place
	}

	option = {
		name = EVTOPTB70001

		wealth = 200
		prestige = -100

		any_realm_character = {
			limit = { has_character_flag = attending_tournament }
			character_event = { id = 70037 }
		}
	}
}

# Tournament has been cancelled - guest
character_event = {
	id = 70037
	title = TOURNAMENTTITLE
	desc = EVTDESC70037
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		clr_character_flag = attending_tournament
		clr_character_flag = do_not_disturb
		clr_character_flag = tournament_winner
		clr_character_flag = tournament_third_place
		clr_character_flag = tournament_second_place
		clear_delayed_event = { id = 70034 }
		clear_delayed_event = { id = 70035 }
		clear_delayed_event = { id = 70036 }
		clear_delayed_event = { id = 70050 }
		clear_delayed_event = { id = 70060 }
	}

	option = {
		name = EVTOPTA70037

		prestige = -50
	}
}

# Message about death
character_event = {
	id = 70038
	title = TOURNAMENTTITLE
	desc = EVTDESC70038
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	trigger = {
		NOT = { has_character_flag = no_msg_death }
	}

	option = {
		name = EVTOPTA70038
	}

	option = {
		name = EVTOPTB70038

		set_character_flag = no_msg_death
	}
}

# Message about maimed
character_event = {
	id = 70039
	title = TOURNAMENTTITLE
	desc = EVTDESC70039
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	trigger = {
		NOT = { has_character_flag = no_msg_maimed }
	}

	option = {
		name = EVTOPTA70038
	}

	option = {
		name = EVTOPTB70038

		set_character_flag = no_msg_maimed
	}
}

# Message about wounded
character_event = {
	id = 70040
	title = TOURNAMENTTITLE
	desc = EVTDESC70040
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	trigger = {
		NOT = { has_character_flag = no_msg_wounded }
	}

	option = {
		name = EVTOPTA70038
	}

	option = {
		name = EVTOPTB70038

		set_character_flag = no_msg_wounded
	}
}

# Tournament is over
character_event = {
	id = 70002
	title = TOURNAMENTTITLE
	desc = EVTDESC70002
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70002

		custom_tooltip = {
			text = EVTOPTA70002_TOOLTIP

			clr_character_flag = attending_tournament
			clr_character_flag = do_not_disturb
			clr_character_flag = tournament_third_place
			clr_character_flag = tournament_second_place
			clr_character_flag = tournament_winner
			clr_character_flag = epic_tournament

			any_realm_character = {
				limit = { has_character_flag = attending_tournament }

				clr_character_flag = attending_tournament
				clr_character_flag = do_not_disturb

				opinion = {
					name = opinion_tournament_participant
					who = PREV
					years = 5
				}

				if = {
					limit = {
						OR = {
							has_character_flag = tournament_third_place
							has_character_flag = tournament_second_place
							has_character_flag = tournament_winner
						}
					}

					clr_character_flag = tournament_third_place
					clr_character_flag = tournament_second_place
					clr_character_flag = tournament_winner
				}
				else_if = {
					limit = {
						NOT = { character = ROOT }
					}

					random_list = {
						10 = { character_event = { id = 70003 } }
						10 = { character_event = { id = 70004 } }
						10 = { character_event = { id = 70005 } }
						10 = { character_event = { id = 70006 } }
						10 = { character_event = { id = 70007 } }
						10 = { character_event = { id = 70008 } }
					}

					clr_character_flag = tourney_score_15
					clr_character_flag = tourney_score_14
					clr_character_flag = tourney_score_13
					clr_character_flag = tourney_score_12
					clr_character_flag = tourney_score_11
					clr_character_flag = tourney_score_10
					clr_character_flag = tourney_score_09
					clr_character_flag = tourney_score_08
					clr_character_flag = tourney_score_07
					clr_character_flag = tourney_score_06
					clr_character_flag = tourney_score_05
					clr_character_flag = tourney_score_04
					clr_character_flag = tourney_score_03
					clr_character_flag = tourney_score_02
					clr_character_flag = tourney_score_01
					clr_character_flag = tourney_score_00
				}
			}
		}

		if = {
			limit = { has_dlc = "Reapers" }

			custom_tooltip = {
				text = capital_prospers_custom_tooltip

				capital_scope = {
					change_variable = {
						which = prosperity_value
						value = 15
					}
				}
			}
		}
	}
}

# End of tournament event
character_event = {
	id = 70003
	title = TOURNAMENTTITLE
	desc = EVTDESC70003
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70003

		prestige = 50
	}
}

# End of tournament event
character_event = {
	id = 70004
	title = TOURNAMENTTITLE
	desc = EVTDESC70004
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70004

		prestige = 100
	}
}

# End of tournament event
character_event = {
	id = 70005
	title = TOURNAMENTTITLE
	desc = EVTDESC70005
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70005

		prestige = -50
	}
}

# End of tournament event
character_event = {
	id = 70006
	title = TOURNAMENTTITLE
	desc = EVTDESC70006
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70006

		prestige = -100
	}
}

# End of tournament event
character_event = {
	id = 70007
	title = TOURNAMENTTITLE
	desc = EVTDESC70007
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70007

		change_martial = 1
	}
}

# End of tournament event
character_event = {
	id = 70008
	title = TOURNAMENTTITLE
	desc = EVTDESC70008
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70008

		change_martial = -1
	}
}

# Character is killed
character_event = {
	id = 70009
	title = TOURNAMENTTITLE
	desc = EVTDESC70009
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70009

		death = { death_reason = death_battle }

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 70038 }
			}
		}
	}
}

# Character is maimed
character_event = {
	id = 70010
	title = TOURNAMENTTITLE
	desc = EVTDESC70010
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70010

		add_maimed_trait_effect = yes

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 70039 }
			}
		}
	}
}

# Character is wounded
character_event = {
	id = 70011
	title = TOURNAMENTTITLE
	desc = EVTDESC70011
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70011

		add_trait = wounded

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = { id = 70040 }
			}
		}
	}
}

# Character becomes craven
character_event = {
	id = 70012
	title = TOURNAMENTTITLE
	desc = EVTDESC70012
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70012

		add_trait_fully_silently_craven_effect = yes
	}
}

# Character becomes brave
character_event = {
	id = 70013
	title = TOURNAMENTTITLE
	desc = EVTDESC70013
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70013

		add_trait_fully_silently_brave_effect = yes
	}
}

# Character becomes tough soldier
character_event = {
	id = 70014
	title = TOURNAMENTTITLE
	desc = EVTDESC70014
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70014

		remove_trait = misguided_warrior
		add_trait = tough_soldier
	}
}

# Character becomes skilled tactician
character_event = {
	id = 70015
	title = TOURNAMENTTITLE
	desc = EVTDESC70015
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70015

		remove_trait = tough_soldier
		add_trait = skilled_tactician
	}
}

# Character becomes brilliant strategist
character_event = {
	id = 70016
	title = TOURNAMENTTITLE
	desc = EVTDESC70016
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70016

		remove_trait = skilled_tactician
		add_trait = brilliant_strategist
	}
}

# Character becomes skilled tactician
character_event = {
	id = 70017
	title = TOURNAMENTTITLE
	desc = EVTDESC70017
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70017

		remove_trait = brilliant_strategist
		add_trait = skilled_tactician
	}
}

# Character becomes tough soldier
character_event = {
	id = 70018
	title = TOURNAMENTTITLE
	desc = EVTDESC70018
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70018

		remove_trait = skilled_tactician
		add_trait = tough_soldier
	}
}

# Character becomes misguided warrior
character_event = {
	id = 70019
	title = TOURNAMENTTITLE
	desc = EVTDESC70019
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70019

		remove_trait = tough_soldier
		add_trait = misguided_warrior
	}
}

# Character gets top placement in the tournament
character_event = {
	id = 70020
	title = TOURNAMENTTITLE
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	desc = {
		text = EVTDESC70020
		trigger = { has_character_flag = tournament_winner }
	}
	desc = {
		text = EVTDESC70021
		trigger = { has_character_flag = tournament_second_place }
	}
	desc = {
		text = EVTDESC70022
		trigger = { has_character_flag = tournament_third_place }
	}

	is_triggered_only = yes

	min_age = 16
	only_capable = yes
	prisoner = no

	option = {
		name = EVTOPTA70020

		trigger = { has_character_flag = tournament_winner }

		wealth = 100
		prestige = 300

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 70034
					days = 3
				}
			}
		}
	}

	option = {
		name = EVTOPTA70021

		trigger = { has_character_flag = tournament_second_place }

		wealth = 75
		prestige = 250

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 70035
					days = 2
				}
			}
		}
	}

	option = {
		trigger = { has_character_flag = tournament_third_place }

		name = EVTOPTA70022

		wealth = 50
		prestige = 200

		if = {
			limit = { independent = no }

			top_liege = {
				character_event = {
					id = 70036
					days = 1
				}
			}
		}
	}
}

# Inform about winner
character_event = {
	id = 70034
	title = TOURNAMENTTITLE
	desc = EVTDESC70034
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70034

		opinion = {
			name = opinion_tournament_winner
			who = FROM
			years = 20
		}

		character_event = { id = 70002 }
	}
}

# Inform about second place
character_event = {
	id = 70035
	title = TOURNAMENTTITLE
	desc = EVTDESC70035
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70035

		opinion = {
			name = opinion_tournament_second_place
			who = FROM
			years = 15
		}
	}
}

# Inform about third place
character_event = {
	id = 70036
	title = TOURNAMENTTITLE
	desc = EVTDESC70036
	picture = GFX_evt_joust
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70036

		opinion = {
			name = opinion_tournament_third_place
			who = FROM
			years = 10
		}
	}
}

# Character becomes homosexual
character_event = {
	id = 70023
	title = TOURNAMENTTITLE
	desc = EVTDESC70023
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70023

		add_trait = homosexual
	}
}

# Character becomes great_pox
character_event = {
	id = 70024
	title = TOURNAMENTTITLE
	desc = EVTDESC70024
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70024

		give_great_pox_effect = yes
	}
}

# Character becomes drunkard
character_event = {
	id = 70025
	title = TOURNAMENTTITLE
	desc = EVTDESC70025
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70025

		add_trait = drunkard
	}
}

# Character becomes duelist
character_event = {
	id = 70026
	title = TOURNAMENTTITLE
	desc = EVTDESC70026
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70026

		add_trait = duelist
	}
}

# Character gains intrigue
character_event = {
	id = 70027
	title = TOURNAMENTTITLE
	desc = EVTDESC70027
	picture = GFX_evt_whispers
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70027

		change_intrigue = 1
	}
}

# Character loses intrigue
character_event = {
	id = 70028
	title = TOURNAMENTTITLE
	desc = EVTDESC70028
	picture = GFX_evt_whispers
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70028

		change_intrigue = -1
	}
}

# Character gains stewardship
character_event = {
	id = 70029
	title = TOURNAMENTTITLE
	desc = EVTDESC70029
	picture = GFX_evt_market
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70029

		change_stewardship = 1
	}
}

# Character loses stewardship
character_event = {
	id = 70030
	title = TOURNAMENTTITLE
	desc = EVTDESC70030
	picture = GFX_evt_market
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70030

		change_stewardship = -1
	}
}

# Character gains diplomacy
character_event = {
	id = 70031
	title = TOURNAMENTTITLE
	desc = EVTDESC70031
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70031

		change_diplomacy = 1
	}
}

# Character loses diplomacy
character_event = {
	id = 70032
	title = TOURNAMENTTITLE
	desc = EVTDESC70032
	picture = GFX_evt_council
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA70032

		change_diplomacy = -1
	}
}

# Invitations have gone out
character_event = {
	id = 70033
	title = TOURNAMENTTITLE
	desc = EVTDESC70033
	picture = GFX_evt_courier
	border = GFX_event_normal_frame_war

	is_triggered_only = yes # hold_a_epic_tournament, realm_decisions.txt

	option = {
		name = EVTOPTA70033

		character_event = {
			id = 70001 # Tournament start
			days = 60
		}

		any_realm_character = {
			limit = {
				OR = {
					is_feudal = yes
					is_tribal = yes
					is_nomadic = yes
				}

				block_general_event_trigger = no
				is_female = no
				practical_age < 50
				NOT = { has_job_title = job_spiritual }
			}

			character_event = { id = 70000 } # Receive invitation
		}
	}
}

# Ruler has died, the tournament is over
character_event = {
	id = 70041
	title = TOURNAMENTTITLE
	desc = EVTDESC70041
	picture = GFX_evt_death
	border = GFX_event_normal_frame_war

	is_triggered_only = yes # on_death

	trigger = { has_character_flag = epic_tournament }

	immediate = {
		clr_character_flag = attending_tournament
		clr_character_flag = tournament_third_place
		clr_character_flag = tournament_second_place
		clr_character_flag = tournament_winner
		clr_character_flag = do_not_disturb
		clear_delayed_event = { id = 70001 }
		clear_delayed_event = { id = 70050 }
		clear_delayed_event = { id = 70060 }
		clear_delayed_event = { id = 70061 }
		clear_delayed_event = { id = 70062 }
		clear_delayed_event = { id = 70063 }
		clear_delayed_event = { id = 70064 }

		any_realm_character = {
			limit = { has_character_flag = attending_tournament }

			letter_event = {
				id = 70042 # Inform of tournament cancellation
				days = 2
				random = 2
			}

			clr_character_flag = tournament_third_place
			clr_character_flag = tournament_second_place
			clr_character_flag = tournament_winner
			clr_character_flag = attending_tournament
			clr_character_flag = do_not_disturb
			clear_delayed_event = { id = 70034 }
			clear_delayed_event = { id = 70035 }
			clear_delayed_event = { id = 70036 }
			clear_delayed_event = { id = 70050 }
			clear_delayed_event = { id = 70060 }
		}
	}

	option = {
		name = EVTOPTA70041

		custom_tooltip = { text = EVTTOOLTIP70042 }
	}
}

# The tournament has been cancelled due to Ruler's death
letter_event = {
	id = 70042
	title = TOURNAMENTTITLE
	desc = EVTDESC70042

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA70042
	}
}

# Tournament attender event for random occurences
character_event = {
	id = 70050

	hide_window = yes
	is_triggered_only = yes

	min_age = 16
	only_capable = yes
	prisoner = no

	immediate = {
		random_list = {
			10 = { # character is killed
				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				mult_modifier = {
					factor = 2
					is_maimed_trigger = yes
				}

				character_event = { id = 70009 }
			}

			13 = { # character maimed
				trigger = { can_be_maimed_trigger = yes }

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				character_event = { id = 70010 }
			}

			20 = { # character wounded
				trigger = {
					is_maimed_trigger = no
					NOT = { trait = wounded }
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				mult_modifier = {
					factor = 0.5
					trait = craven
				}

				mult_modifier = {
					factor = 2
					trait = brave
				}

				character_event = { id = 70011 }
			}

			40 = { # gain craven
				trigger = {
					NOR = {
						trait = craven
						trait = berserker
					}
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 0.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 1.5
					combat_rating < 0
				}

				character_event = { id = 70012 }
			}

			40 = { # gain brave
				trigger = {
					NOT = { trait = brave }
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 40
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 30
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 20
				}

				mult_modifier = {
					factor = 1.5
					combat_rating >= 10
				}

				mult_modifier = {
					factor = 0.5
					combat_rating < 10
				}

				mult_modifier = {
					factor = 0.5
					combat_rating < 0
				}

				character_event = { id = 70013 }
			}

			40 = { # promoted to tough soldier
				trigger = { trait = misguided_warrior }

				character_event = { id = 70014 }
			}

			40 = { # promoted to skilled tactician
				trigger = { trait = tough_soldier }

				character_event = { id = 70015 }
			}

			40 = { # promoted to brilliant strategist
				trigger = { trait = skilled_tactician }

				character_event = { id = 70016 }
			}

			40 = { # demoted to skilled tactician
				trigger = { trait = brilliant_strategist }

				character_event = { id = 70017 }
			}

			40 = { # demoted to tough soldier
				trigger = { trait = skilled_tactician }

				character_event = { id = 70018 }
			}

			40 = { # demoted to misguided warrior
				trigger = { trait = tough_soldier }

				character_event = { id = 70019 }
			}

			13 = { # gain homosexual
				trigger = {
					NOR = {
						trait = homosexual
						trait = celibate
						trait = eunuch
					}
				}

				mult_modifier = {
					factor = 1.2
					trait = drunkard
				}

				mult_modifier = {
					factor = 1.5
					trait = hedonist
				}

				mult_modifier = {
					factor = 1.2
					trait = lustful
				}

				mult_modifier = {
					factor = 0.5
					trait = temperate
				}

				mult_modifier = {
					factor = 0.3
					trait = chaste
				}

				mult_modifier = {
					factor = 0.3
					trait = zealous
				}

				character_event = { id = 70023 }
			}

			13 = { # gain great_pox
				trigger = {
					NOR = {
						trait = great_pox
						trait = celibate
						trait = eunuch
						has_character_flag = developing_illness
						has_character_flag = disease_not_serious
					}
				}

				mult_modifier = {
					factor = 1.2
					trait = drunkard
				}

				mult_modifier = {
					factor = 1.5
					trait = hedonist
				}

				mult_modifier = {
					factor = 1.2
					trait = lustful
				}

				mult_modifier = {
					factor = 0.5
					trait = temperate
				}

				mult_modifier = {
					factor = 0.3
					trait = chaste
				}

				mult_modifier = {
					factor = 0.3
					trait = zealous
				}

				character_event = { id = 70024 }
			}

			20 = { # gain drunkard
				trigger = {
					NOT = { trait = drunkard }
				}

				mult_modifier = {
					factor = 1.3
					trait = gluttonous
				}

				mult_modifier = {
					factor = 1.1
					trait = lustful
				}

				mult_modifier = {
					factor = 0.3
					trait = temperate
				}

				mult_modifier = {
					factor = 0.5
					trait = chaste
				}

				character_event = { id = 70025 }
			}

			20 = { # gain duelist
				trigger = {
					lifestyle_traits < 1
					martial >= 5
					is_weak_trigger = no

					NOR = {
						has_dlc = "Way of Life"
						trait = content
						trait = kind
						trait = craven
					}
				}

				mult_modifier = {
					factor = 1.3
					trait = diligent
				}

				mult_modifier = {
					factor = 1.3
					trait = wroth
				}

				mult_modifier = {
					factor = 1.3
					trait = brave
				}

				mult_modifier = {
					factor = 1.3
					is_strong_trigger = yes
				}

				mult_modifier = {
					factor = 1.3
					martial >= 10
				}

				mult_modifier = {
					factor = 1.3
					martial >= 15
				}

				mult_modifier = {
					factor = 1.3
					martial >= 20
				}

				character_event = { id = 70026 }
			}

			40 = { # increase intrigue
				mult_modifier = {
					factor = 1.2
					trait = elusive_shadow
				}

				mult_modifier = {
					factor = 1.1
					trait = intricate_webweaver
				}

				mult_modifier = {
					factor = 0.9
					trait = flamboyant_schemer
				}

				mult_modifier = {
					factor = 0.7
					trait = amateurish_plotter
				}

				mult_modifier = {
					factor = 0.7
					has_education_intrigue_trigger = no
				}

				mult_modifier = {
					factor = 1.1
					trait = deceitful
				}

				mult_modifier = {
					factor = 0.7
					trait = honest
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 70027 }
			}

			40 = { # decrease intrigue
				mult_modifier = {
					factor = 0.8
					trait = elusive_shadow
				}

				mult_modifier = {
					factor = 0.9
					trait = intricate_webweaver
				}

				mult_modifier = {
					factor = 1.1
					trait = flamboyant_schemer
				}

				mult_modifier = {
					factor = 1.5
					trait = amateurish_plotter
				}

				mult_modifier = {
					factor = 0.7
					has_education_intrigue_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = deceitful
				}

				mult_modifier = {
					factor = 1.5
					trait = honest
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 70028 }
			}

			40 = { # increase stewardship
				mult_modifier = {
					factor = 1.5
					trait = midas_touched
				}

				mult_modifier = {
					factor = 1.1
					trait = fortune_builder
				}

				mult_modifier = {
					factor = 0.9
					trait = thrifty_clerk
				}

				mult_modifier = {
					factor = 0.8
					trait = indulgent_wastrel
				}

				mult_modifier = {
					factor = 0.7
					has_education_stewardship_trigger = no
				}

				mult_modifier = {
					factor = 1.5
					trait = diligent
				}

				mult_modifier = {
					factor = 0.9
					trait = slothful
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 70029 }
			}

			40 = { # decrease stewardship
				mult_modifier = {
					factor = 0.8
					trait = midas_touched
				}

				mult_modifier = {
					factor = 0.9
					trait = fortune_builder
				}

				mult_modifier = {
					factor = 1.1
					trait = thrifty_clerk
				}

				mult_modifier = {
					factor = 1.5
					trait = indulgent_wastrel
				}

				mult_modifier = {
					factor = 0.7
					has_education_stewardship_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = diligent
				}

				mult_modifier = {
					factor = 1.5
					trait = slothful
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 70030 }
			}

			40 = { # increase diplomacy
				mult_modifier = {
					factor = 1.5
					trait = grey_eminence
				}

				mult_modifier = {
					factor = 1.1
					trait = charismatic_negotiator
				}

				mult_modifier = {
					factor = 0.9
					trait = underhanded_rogue
				}

				mult_modifier = {
					factor = 0.8
					trait = naive_appeaser
				}

				mult_modifier = {
					factor = 0.7
					has_education_diplomacy_trigger = no
				}

				mult_modifier = {
					factor = 1.5
					trait = gregarious
				}

				mult_modifier = {
					factor = 0.9
					trait = shy
				}

				character_event = { id = 70031 }
			}

			40 = { # decrease diplomacy
				mult_modifier = {
					factor = 0.8
					trait = grey_eminence
				}

				mult_modifier = {
					factor = 0.9
					trait = charismatic_negotiator
				}

				mult_modifier = {
					factor = 1.1
					trait = underhanded_rogue
				}

				mult_modifier = {
					factor = 1.5
					trait = naive_appeaser
				}

				mult_modifier = {
					factor = 0.7
					has_education_diplomacy_trigger = no
				}

				mult_modifier = {
					factor = 0.9
					trait = gregarious
				}

				mult_modifier = {
					factor = 1.5
					trait = shy
				}

				mult_modifier = {
					factor = 0.25
					martial >= 10
				}

				mult_modifier = {
					factor = 1.2
					martial < 5
				}

				character_event = { id = 70032 }
			}

			20 = { # Accuse rival of cheating in tournament
				trigger = {
					is_ruler = yes
					is_female = no
					war = no
					in_command = no

					any_rival = {
						has_character_flag = attending_tournament
						is_female = no
						same_liege = ROOT
						NOT = { vassal_of = ROOT }
						war = no
						in_command = no
						prisoner = no
						is_incapable = no
					}
				}

				mult_modifier = {
					factor = 0.25
					trait = honest
				}

				mult_modifier = {
					factor = 0.5
					trait = trusting
				}

				mult_modifier = {
					factor = 0.5
					trait = shy
				}

				mult_modifier = {
					factor = 0.5
					trait = cruel
				}

				mult_modifier = {
					factor = 2
					trait = gregarious
				}

				mult_modifier = {
					factor = 2
					trait = kind
				}

				mult_modifier = {
					factor = 2
					trait = deceitful
				}

				mult_modifier = {
					factor = 2
					trait = paranoid
				}

				character_event = { id = 100420 }
			}

			1000 = { }
		}
	}
}

###########################################
# SCORING, LOOK AWAY FRAGILE EYES         #
###########################################

character_event = {
	id = 70060

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_list = {
			10 = {
				trigger = { combat_rating >= 130 }

				set_character_flag = tourney_score_15
			}

			10 = {
				trigger = {
					combat_rating >= 120
					combat_rating < 170
				}

				set_character_flag = tourney_score_14
			}

			10 = {
				trigger = {
					combat_rating >= 110
					combat_rating < 160
				}

				set_character_flag = tourney_score_13
			}

			10 = {
				trigger = {
					combat_rating >= 100
					combat_rating < 150
				}

				set_character_flag = tourney_score_12
			}

			10 = {
				trigger = {
					combat_rating >= 90
					combat_rating < 140
				}

				set_character_flag = tourney_score_11
			}

			10 = {
				trigger = {
					combat_rating >= 80
					combat_rating < 130
				}

				set_character_flag = tourney_score_10
			}

			10 = {
				trigger = {
					combat_rating >= 70
					combat_rating < 120
				}

				set_character_flag = tourney_score_09
			}

			10 = {
				trigger = {
					combat_rating >= 60
					combat_rating < 110
				}

				set_character_flag = tourney_score_08
			}

			10 = {
				trigger = {
					combat_rating >= 50
					combat_rating < 100
				}

				set_character_flag = tourney_score_07
			}

			10 = {
				trigger = {
					combat_rating >= 40
					combat_rating < 90
				}

				set_character_flag = tourney_score_06
			}

			10 = {
				trigger = {
					combat_rating >= 30
					combat_rating < 80
				}

				set_character_flag = tourney_score_05
			}

			10 = {
				trigger = {
					combat_rating >= 20
					combat_rating < 70
				}

				set_character_flag = tourney_score_04
			}

			10 = {
				trigger = {
					combat_rating >= 10
					combat_rating < 60
				}

				set_character_flag = tourney_score_03
			}

			10 = {
				trigger = { combat_rating < 50 }

				set_character_flag = tourney_score_02
			}

			10 = {
				trigger = { combat_rating < 40 }

				set_character_flag = tourney_score_01
			}

			10 = {
				trigger = { combat_rating < 30 }

				set_character_flag = tourney_score_00
			}
		}
	}
}

###########################################
# First place   WINNER!                   #
###########################################

character_event = {
	id = 70061

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_winner
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_winner
		}
	}
}

###########################################
# Second place                            #
###########################################

character_event = {
	id = 70062

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_second_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_second_place
		}
	}
}

###########################################
# Third place                           #
###########################################

character_event = {
	id = 70063

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_realm_character = {
			limit = { has_character_flag = tourney_score_15 }
			clr_character_flag = tourney_score_15
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_14 }
			clr_character_flag = tourney_score_14
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_13 }
			clr_character_flag = tourney_score_13
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_12 }
			clr_character_flag = tourney_score_12
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_11 }
			clr_character_flag = tourney_score_11
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_10 }
			clr_character_flag = tourney_score_10
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_09 }
			clr_character_flag = tourney_score_09
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_08 }
			clr_character_flag = tourney_score_08
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_07 }
			clr_character_flag = tourney_score_07
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_06 }
			clr_character_flag = tourney_score_06
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_05 }
			clr_character_flag = tourney_score_05
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_04 }
			clr_character_flag = tourney_score_04
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_03 }
			clr_character_flag = tourney_score_03
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_02 }
			clr_character_flag = tourney_score_02
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_01 }
			clr_character_flag = tourney_score_01
			set_character_flag = tournament_third_place
			break = yes
		}
		random_realm_character = {
			limit = { has_character_flag = tourney_score_00 }
			clr_character_flag = tourney_score_00
			set_character_flag = tournament_third_place
		}
	}
}

###########################################
# Notify winners						  #
###########################################

character_event = {
	id = 70064

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		any_realm_character = {
			limit = {
				OR = {
					has_character_flag = tournament_winner
					has_character_flag = tournament_second_place
					has_character_flag = tournament_third_place
				}
			}

			character_event = { id = 70020 }
		}
	}
}

###########################################
# Flag management                         #
###########################################

# Safety catch - clears character flags and modifiers - removed by CleanSlate

###########################################

### Accuse rival of cheating in tournament ###
# CleanSlate: Moved here from base_friends_rivals_events.txt. Now fires directly from the tournament tombola rather than on_yearly_pulse
character_event = {
	id = 100420
	desc = EVTDESC100420
	picture = GFX_evt_joust

	is_triggered_only = yes

	immediate = {
		random_rival = {
			limit = {
				has_character_flag = attending_tournament
				same_liege = ROOT
				NOT = { vassal_of = ROOT }
				war = no
				in_command = no
				prisoner = no
				is_incapable = no
			}

			save_event_target_as = tournament_rival
		}
	}

	option = {
		name = EVTOPTA100420

		liege = {
			show_scope_change = no

			character_event = {
				id = 100421
				days = 2
				random = 2
				tooltip = EVTTOOLTIP100421
			}
		}
	}

	option = {
		name = EVTOPTB100420

		event_target:tournament_rival = {
			show_scope_change = no

			opinion = {
				name = opinion_angry
				who = ROOT
				years = 10
			}

			character_event = {
				id = 100422
				days = 2
				random = 2
				tooltip = EVTTOOLTIP100422
			}
		}
	}

	option = {
		name = EVTOPTC100420

		opinion = {
			name = opinion_disgraceful
			who = event_target:tournament_rival
			years = 10
		}

		event_target:tournament_rival = {
			show_scope_change = no

			liege = {
				show_scope_change = no

				any_vassal = {
					show_scope_change = no

					limit = {
						prisoner = no

						NOR = {
							vassal_of = ROOT
							character = ROOT
						}
					}

					opinion = {
						name = opinion_disgraceful
						who = PREV
						years = 10
					}
				}
			}

			character_event = {
				id = 100423
				days = 2
				random = 2
				tooltip = EVTTOOLTIP100423
			}
		}
	}

	option = {
		name = EVTOPTD100420

		prestige = -10
	}
}

# Liege is told about cheating rival
character_event = {
	id = 100421
	desc = EVTDESC100421
	picture = GFX_evt_joust

	is_triggered_only = yes

	option = {
		name = EVTOPTA100421

		if = {
			limit = { personality_traits < 5 }

			random = {
				chance = 20
				add_trait_fully_just_effect = yes
			}
		}

		event_target:tournament_rival = {
			show_scope_change = no

			# Tournament clean-up
			clr_character_flag = tournament_third_place
			clr_character_flag = tournament_second_place
			clr_character_flag = tournament_winner
			clr_character_flag = attending_tournament
			clr_character_flag = do_not_disturb
			clear_delayed_event = { id = 70034 }
			clear_delayed_event = { id = 70035 }
			clear_delayed_event = { id = 70036 }
			clear_delayed_event = { id = 70050 }
			clear_delayed_event = { id = 70060 }

			imprison = ROOT

			character_event = {
				id = 100424
				tooltip = EVTTOOLTIP100424
			}
		}

		FROM = {
			set_character_flag = rival_imprisoned

			character_event = {
				id = 100426
				days = 7
				random = 7
			}
		}
	}

	option = {
		name = EVTOPTB100421

		event_target:tournament_rival = {
			show_scope_change = no

			# Tournament clean-up
			clr_character_flag = tournament_third_place
			clr_character_flag = tournament_second_place
			clr_character_flag = tournament_winner
			clr_character_flag = attending_tournament
			clr_character_flag = do_not_disturb
			clear_delayed_event = { id = 70034 }
			clear_delayed_event = { id = 70035 }
			clear_delayed_event = { id = 70036 }
			clear_delayed_event = { id = 70050 }
			clear_delayed_event = { id = 70060 }

			banish = yes

			character_event = {
				id = 100425
				tooltip = EVTTOOLTIP100425
			}
		}

		FROM = {
			set_character_flag = rival_banished

			character_event = {
				id = 100426
				days = 7
				random = 7
			}
		}
	}

	option = {
		name = EVTOPTC100421

		if = {
			limit = { personality_traits < 5 }

			random = {
				chance = 20
				add_trait_fully_arbitrary_effect = yes
			}
		}

		FROM = {
			show_scope_change = no

			opinion = {
				name = opinion_disappointed
				who = ROOT
				years = 5
			}

			character_event = {
				id = 100426
				days = 7
				random = 7
			}
		}
	}
}

# Cheating rival is confronted
character_event = {
	id = 100422
	desc = EVTDESC100422
	picture = GFX_evt_joust

	is_triggered_only = yes

	option = {
		name = EVTOPTA100422

		tooltip = {
			opinion = {
				name = opinion_angry
				who = FROM
				years = 10
			}
		}
	}

	option = {
		name = EVTOPTB100422

		tooltip = {
			opinion = {
				name = opinion_angry
				who = FROM
				years = 10
			}
		}

		FROM = {
			show_scope_change = no

			character_event = { # TODO: Update with standard duel mechanics?
				id = 100427
				days = 2
				random = 2
				tooltip = EVTTOOLTIP100427
			}
		}
	}
}

# Cheating rival attempts to clear his name
character_event = {
	id = 100423
	desc = EVTDESC100423
	picture = GFX_evt_joust

	is_triggered_only = yes

	option = {
		name = EVTOPTA100423

		scaled_wealth = -0.25

		liege = {
			show_scope_change = no

			any_vassal = {
				show_scope_change = no

				limit = {
					prisoner = no

					has_opinion_modifier = {
						name = opinion_disgraceful
						who = ROOT
					}
				}

				remove_opinion = {
					name = opinion_disgraceful
					who = ROOT
				}
			}
		}
	}

	option = {
		name = EVTOPTB100423

		prestige = -10
	}
}

# Cheating rival is imprisoned by liege
character_event = {
	id = 100424
	desc = EVTDESC100424
	picture = GFX_evt_into_the_dungeon

	is_triggered_only = yes

	option = {
		name = EVTOPTA100424

		tooltip = {
			imprison = FROM
		}

		opinion = {
			name = opinion_revenge_seeker
			who = FROMFROM
			years = 10
		}
	}
}

# Cheating rival is banished by liege
character_event = {
	id = 100425
	desc = EVTDESC100425
	picture = GFX_evt_carriage

	is_triggered_only = yes

	option = {
		name = EVTOPTA100425

		tooltip = {
			banish = yes
		}

		opinion = {
			name = opinion_furious
			who = FROMFROM
			years = 10
		}
	}
}

# Liege banished/imprisoned/did nothing
character_event = {
	id = 100426
	desc = EVTDESC100426
	picture = GFX_evt_joust

	is_triggered_only = yes

	option = {
		name = EVTOPTA100426

		trigger = {
			NOR = {
				has_character_flag = rival_banished
				has_character_flag = rival_imprisoned
			}
		}

		opinion = {
			name = opinion_disappointed
			who = FROM
			years = 5
		}
	}

	option = {
		name = EVTOPTB100426

		trigger = { has_character_flag = rival_imprisoned }

		clr_character_flag = rival_imprisoned

		opinion = {
			name = opinion_glad
			who = FROM
			years = 5
		}
	}

	option = {
		name = EVTOPTC100426

		trigger = { has_character_flag = rival_banished }

		clr_character_flag = rival_banished

		opinion = {
			name = opinion_glad
			who = FROM
			years = 5
		}
	}
}

# ROOT is challenged to a duel
character_event = {
	id = 100427
	desc = EVTDESC100427
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = EVTOPTA100427

		FROM = {
			show_scope_change = no

			if = {
				limit = {
					combat_rating >= 10
					combat_rating < 20

					ROOT = {
						combat_rating >= 20
						combat_rating < 30
					}
				}

				random = {
					chance = 15
					add_trait_wounded_effect = yes
				}
			}

			if = {
				limit = {
					combat_rating >= 20
					combat_rating < 30

					ROOT = {
						combat_rating >= 10
						combat_rating < 20
					}
				}

				ROOT = {
					random = {
						chance = 15
						add_trait_wounded_effect = yes
					}
				}

				character_event = {
					id = 100428
					tooltip = EVTTOOLTIP100428
				}
			}

			if = {
				limit = {
					combat_rating >= 20
					combat_rating < 30

					ROOT = {
						combat_rating >= 30
						combat_rating < 40
					}
				}

				random = {
					chance = 20

					add_trait_wounded_effect = yes

					character_event = {
						id = 100428
						tooltip = EVTTOOLTIP100428
					}
				}
			}

			if = {
				limit = {
					combat_rating >= 30
					combat_rating < 40

					ROOT = {
						combat_rating >= 20
						combat_rating < 30
					}
				}

				ROOT = {
					random = {
						chance = 20
						add_trait_wounded_effect = yes
					}
				}

				character_event = {
					id = 100428
					tooltip = EVTTOOLTIP100428
				}
			}

			if = {
				limit = {
					combat_rating >= 30
					combat_rating < 40

					ROOT = {
						combat_rating >= 40
					}
				}

				random = {
					chance = 25

					add_trait_wounded_effect = yes

					character_event = {
						id = 100428
						tooltip = EVTTOOLTIP100428
					}
				}
			}

			if = {
				limit = {
					combat_rating >= 40

					ROOT = {
						combat_rating >= 30
						combat_rating < 40
					}
				}

				ROOT = {
					random = {
						chance = 25
						add_trait_wounded_effect = yes
					}
				}

				character_event = {
					id = 100428
					tooltip = EVTTOOLTIP100428
				}
			}
		}
	}

	option = {
		name = EVTOPTB100427

		prestige = -20

		FROM = {
			show_scope_change = no

			opinion = {
				name = opinion_coward
				who = ROOT
				years = 10
			}

			character_event = {
				id = 100429
				tooltip = EVTTOOLTIP100429
			}
		}

		if = {
			limit = { personality_traits < 5 }
			add_trait_fully_silently_craven_effect = yes
		}
	}
}

# Rival is beaten?
character_event = {
	id = 100428
	desc = EVTDESC100428
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = EVTOPTA100428
		trigger = {
			trait = wounded

			FROM = {
				NOT = { trait = wounded }
			}
		}

		tooltip = {
			add_trait = wounded
		}

		opinion = {
			name = opinion_revenge_seeker
			who = FROM
			years = 50
		}
	}

	option = {
		name = EVTOPTB100428

		trigger = {
			NOR = {
				trait = wounded
				FROM = { trait = wounded }
			}
		}

		prestige = 10
	}

	option = {
		name = EVTOPTC100428

		trigger = {
			FROM = {
				trait = wounded
			}
		}

		tooltip = {
			FROM = {
				show_scope_change = no

				add_trait = wounded
			}
		}

		reverse_opinion = {
			name = opinion_revenge_seeker
			who = FROM
			years = 50
		}

		prestige = 10
	}
}

# Rival is disappointed in ROOT
character_event = {
	id = 100429
	desc = EVTDESC100429
	picture = GFX_evt_melee

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTA100429

		tooltip = {
			opinion = {
				name = opinion_coward
				who = FROM
				years = 10
			}
		}
	}
}